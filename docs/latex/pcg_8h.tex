\doxysection{C\+:/\+Users/\+James/\+Documents/\+Lin\+Alg\+Lib/library/include/\+Linear\+Solvers/pcg.h File Reference}
\hypertarget{pcg_8h}{}\label{pcg_8h}\index{C:/Users/James/Documents/LinAlgLib/library/include/LinearSolvers/pcg.h@{C:/Users/James/Documents/LinAlgLib/library/include/LinearSolvers/pcg.h}}


\doxylink{pcg_8h}{pcg.\+h} provides interface for preconditioned conjugate gradient solver  


\doxysubsubsection*{Functions}
\textbf{ }\par
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{pcg_8h_a618d885bf782f45224ee5841f21d4ff8}{pcg}} (const int \texorpdfstring{$\ast$}{*}csr\+\_\+row\+\_\+ptr, const int \texorpdfstring{$\ast$}{*}csr\+\_\+col\+\_\+ind, const double \texorpdfstring{$\ast$}{*}csr\+\_\+val, double \texorpdfstring{$\ast$}{*}x, const double \texorpdfstring{$\ast$}{*}b, const int n, const double tol, const int max\+\_\+iter)
\begin{DoxyCompactList}\small\item\em Preconditioned conjugate gradient iterative linear solver. \end{DoxyCompactList}\item 
\Hypertarget{pcg_8h_a0bacf9256f2fd79b986429cabb6f62ee}\label{pcg_8h_a0bacf9256f2fd79b986429cabb6f62ee} 
int {\bfseries pcg2} (const int \texorpdfstring{$\ast$}{*}csr\+\_\+row\+\_\+ptr, const int \texorpdfstring{$\ast$}{*}csr\+\_\+col\+\_\+ind, const double \texorpdfstring{$\ast$}{*}csr\+\_\+val, double \texorpdfstring{$\ast$}{*}x, const double \texorpdfstring{$\ast$}{*}b, const int n, const double tol, const int max\+\_\+iter)
\end{DoxyCompactItemize}



\doxysubsection{Detailed Description}
\doxylink{pcg_8h}{pcg.\+h} provides interface for preconditioned conjugate gradient solver 



\doxysubsection{Function Documentation}
\Hypertarget{pcg_8h_a618d885bf782f45224ee5841f21d4ff8}\label{pcg_8h_a618d885bf782f45224ee5841f21d4ff8} 
\index{pcg.h@{pcg.h}!pcg@{pcg}}
\index{pcg@{pcg}!pcg.h@{pcg.h}}
\doxysubsubsection{\texorpdfstring{pcg()}{pcg()}}
{\footnotesize\ttfamily int pcg (\begin{DoxyParamCaption}\item[{const int \texorpdfstring{$\ast$}{*}}]{csr\+\_\+row\+\_\+ptr,  }\item[{const int \texorpdfstring{$\ast$}{*}}]{csr\+\_\+col\+\_\+ind,  }\item[{const double \texorpdfstring{$\ast$}{*}}]{csr\+\_\+val,  }\item[{double \texorpdfstring{$\ast$}{*}}]{x,  }\item[{const double \texorpdfstring{$\ast$}{*}}]{b,  }\item[{const int}]{n,  }\item[{const double}]{tol,  }\item[{const int}]{max\+\_\+iter }\end{DoxyParamCaption})}



Preconditioned conjugate gradient iterative linear solver. 

{\ttfamily pcg} solves the sparse linear system A\texorpdfstring{$\ast$}{*}x = b using the preconditioned conjugate gradient iterative solver.

\begin{DoxyNote}{Note}
Requires the sparse matrix A to be symmetric
\end{DoxyNote}

\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em csr\+\_\+row\+\_\+ptr} & array of {\ttfamily n+1} elements that point to the start of every row of the sparse CSR matrix. \\
\hline
\mbox{\texttt{ in}}  & {\em csr\+\_\+col\+\_\+ind} & array of {\ttfamily nnz} elements containing the column indices of the sparse CSR matrix. \\
\hline
\mbox{\texttt{ in}}  & {\em csr\+\_\+val} & array of {\ttfamily nnz} elements containing the values of the sparse CSR matrix. \\
\hline
\mbox{\texttt{ in,out}}  & {\em x} & array of {\ttfamily n} elements containing the solution values of A\texorpdfstring{$\ast$}{*}x=b \\
\hline
\mbox{\texttt{ in}}  & {\em b} & array of {\ttfamily n} elements containing the righthad side values of A\texorpdfstring{$\ast$}{*}x=b.\\
\hline
\mbox{\texttt{ in}}  & {\em n} & size of the sparse CSR matrix \\
\hline
\mbox{\texttt{ in}}  & {\em omega} & omega \\
\hline
\mbox{\texttt{ in}}  & {\em tol} & stopping tolerance \\
\hline
\mbox{\texttt{ in}}  & {\em max\+\_\+iter} & maximum iterations allowed\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em number} & of iterations actually used in the solver\\
\hline
\end{DoxyRetVals}
\begin{DoxyParagraph}{Example}

\begin{DoxyCode}{0}
\DoxyCodeLine{std::vector<int>\ csr\_row\_ptr;}
\DoxyCodeLine{std::vector<int>\ csr\_col\_ind;}
\DoxyCodeLine{std::vector<double>\ csr\_val;}
\DoxyCodeLine{load\_mtx\_file(matrix\_file,\ csr\_row\_ptr,\ csr\_col\_ind,\ csr\_val);}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{int}\ m\ =\ (int)csr\_row\_ptr.size()\ -\/\ 1;}
\DoxyCodeLine{\textcolor{keywordtype}{int}\ n\ =\ m;}
\DoxyCodeLine{\textcolor{keywordtype}{int}\ nnz\ =\ (int)csr\_val.size();}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//\ Solution\ vector}}
\DoxyCodeLine{std::vector<double>\ x(m,\ 0.0);}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//\ Righthand\ side\ vector}}
\DoxyCodeLine{std::vector<double>\ b(m,\ 1.0);}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{int}\ it\ =\ \mbox{\hyperlink{pcg_8h_a618d885bf782f45224ee5841f21d4ff8}{pcg}}(csr\_row\_ptr.data(),\ }
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ csr\_col\_ind.data(),\ }
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ csr\_val.data(),\ }
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ x.data(),\ }
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ b.data(),\ }
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ m,\ }
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ 0.00001,\ }
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ 1000);}

\end{DoxyCode}
 
\end{DoxyParagraph}
